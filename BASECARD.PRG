//
//  Модуль управления базой card718
//

//
//  << work >>
//

//
//  Функции модуля
//
//  cardOpen() ->T/F  -  открытие базы card в разделяемом режиме
//  cardXOpen()->T/F  -     ---  //  ---    в эксклюзивном режиме
//  cardClose()       -  закрытие базы
//  cardInfo()        -  структура базы card
//  cardBInfo()       -  информация по основным базам
//  cardInit()        -  инициализация баз карточного учета
//  cardBOpen()       -  открытие основных баз 
//  cardBXOpen()      -  то же в эксклюзивном режиме
//  cardBClose()      -  закрытие основных баз
//
#include "clippExt.ch"
#include "common.ch"

//
//  Открытие базы
//
funcDef cardOpen()
return baseMOpen( cardInfo())


//
//  Открытие базы в экслюзивном режиме
//
Function cardXOpen()
return baseMXOpen( cardInfo() )

//
// Закрытие базы
//
Function cardClose()
return baseMClose( cardInfo() )

//
//  Описание структуры
//
Function cardInfo()
Static aArr := { ".\card718.dbf", "card",;
                 {{ "schet", "C", 20, 0 } ,;   // счет
                  { "sumF",  "N", 15, 0 } ,;   // фиксированная сумма
                  { "_sumF", "N", 15, 0 } ,;
                  { "datF",  "D",  8, 0 } ,;   // и дата ее начисления
                  { "sum1",  "N", 15, 0 } ,;   // сумма, перечисл. с зарплаты
                  { "prc1",  "N",  6, 2 } ,;   // проценты с зарплаты
                  { "dat1",  "D",  8, 0 } ,;   // дата перечисления
                  { "sum2",  "N", 15, 0 } ,;   // сумма, перечисл. с премии
                  { "prc2",  "N",  6, 2 } ,;   // % с премии
                  { "dat2",  "D",  8, 0 } ,;   // дата перечисления
                  { "sum3",  "N", 15, 0 } ,;   // сумма,перечисл. по сроч.вкладу
                  { "prc3",  "N",  6, 2 } ,;   // % со вклада
                  { "dat3",  "D",  8, 0 } ,;
                  { "_datF", "D",  8, 0 } ,;
                  { "_dat1", "D",  8, 0 } ,;
                  { "_dat2", "D",  8, 0 } ,;
                  { "_dat3", "D",  8, 0 } ,;
                  { "crdType","N", 1, 0 } ,;
                  { "crdPay","N",  1, 0 } ,;
                  { "crdOpen","N", 1, 0 } ,;
                  { "dat_kart","D",8, 0 }},;   // дата
                 { { "card718", "schet" } },;
                  1}

return aArr
